\documentclass{beamer}
\usepackage[slovene]{babel}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
%\usepackage[T1]{fontenc}
\setlength\parindent{0pt}
\usetheme{Warsaw}


\begin{document}

\begin{frame}
\frametitle{Podatkovne strukture}
\framesubtitle{Tip}
% Iz katerih podatkovnih struktur gradimo Zastonjske izreke?
\texttt{
{\footnotesize type TypeVariable = String}
\begin{block}{\texttt{data Type}}
\textcolor[rgb]{0,0,1}{\textbf{TypeVar}} \textcolor[rgb]{1,0,0}{TypeVariable} 
\hfill{\small\sffamily spremenljivka} \\
$\qquad${\small a, b, x, y, ...} \\
\textcolor[rgb]{0,0,1}{\textbf{TypeConst}} \textcolor[rgb]{1,0,0}{TypeVariable}
\hfill{\small\sffamily konstantni tip}\\
$\qquad${\small Bool, Int, Double, Char, ...} \\
\textcolor[rgb]{0,0,1}{\textbf{TypeFun}} \textcolor[rgb]{1,0,0}{Type Type}
\hfill{\small\sffamily funkcija} \\
$\qquad${\small a -> b, x -> Bool, [Int] -> Int, ...} \\
\textcolor[rgb]{0,0,1}{\textbf{TypeList}} \textcolor[rgb]{1,0,0}{Type}
\hfill{\small\sffamily seznam} \\
$\qquad${\small [a], [Int], [x -> y], ...} \\
\end{block}
}
\end{frame}

\begin{frame}
\frametitle{Podatkovne strukture}
\framesubtitle{Izraz}
% Izrazi pripadajo tipom.
% Konstantni izrazi so npr True, 2, "whoa", 'b', 3.14, ...
% Lahko so spremenljivke.
% Lahko je aplikacija izraza na izraz, npr. uporaba funkcije na argumentu.
\texttt{
{\footnotesize type TermVariable = String}
\begin{block}{\texttt{data Term}}
\textcolor[rgb]{0,0,1}{\textbf{TermVar}} \textcolor[rgb]{1,0,0}{TermVariable}
\hfill{\small\sffamily spremenljivka} \\
$\qquad${\small x, y, u, v, ...} \\
\textcolor[rgb]{0,0,1}{\textbf{TermApp}} \textcolor[rgb]{1,0,0}{Term Term}
\hfill{\small\sffamily aplikacija izraza na izraz} \\
$\qquad${\small f x, g (f y), ...} \\
\end{block}
}
\end{frame}

\begin{frame}
\frametitle{Podatkovne strukture}
\framesubtitle{Formula}
\texttt{
{\footnotesize type RelationVariable = String}
\begin{block}{\texttt{data Formula}}
\textcolor[rgb]{0,0,1}{\textbf{ForallRelations}} \textcolor[rgb]{1,0,0}{RelationVariable}\\
$\phantom{\textbf{ForallRelations}}$ (\textcolor[rgb]{1,0,0}{TypeVariable}, \textcolor[rgb]{1,0,0}{TypeVariable})\\
$\phantom{\textbf{ForallRelations}}$ \textcolor[rgb]{1,0,0}{Formula}\\
$\qquad${\small $\forall\, \texttt{t}_1, \texttt{t}_2 \in \textsc{Types},\; \texttt{R} \subseteq \texttt{t}_1\times \texttt{t}_2\,$. (\textit{formula})}\\
\textcolor[rgb]{0,0,1}{\textbf{ForallVariables}} \textcolor[rgb]{1,0,0}{TermVariable}
\textcolor[rgb]{1,0,0}{Type} \textcolor[rgb]{1,0,0}{Formula}\\
$\qquad${\small $\forall$ n :: Int . (\textit{formula})}\\
$\qquad${\small $\forall$ g :: $t_1$ -> $t_3$ . (\textit{formula})}\\
\textcolor[rgb]{0,0,1}{\textbf{ForallPairs}} (\textcolor[rgb]{1,0,0}{TermVariable}, \textcolor[rgb]{1,0,0}{TermVariable})\\
$\phantom{\textbf{ForallPairs}}$ \textcolor[rgb]{1,0,0}{RelationVariable}\\
$\phantom{\textbf{ForallPairs}}$ \textcolor[rgb]{1,0,0}{Formula}\\
$\qquad${\small $\forall$ (x, y) $\in$ R. (\textit{formula})}\\
$\qquad${\small $\forall$ (u, v) $\in$ [R -> S]. (\textit{formula})}\\
\end{block}
}
\end{frame}

\begin{frame}
\frametitle{Podatkovne strukture}
\framesubtitle{Formula}
\texttt{
\begin{block}{\texttt{data Formula}}
$\vdots$\\
\textcolor[rgb]{0,0,1}{\textbf{IsMember}} (\textcolor[rgb]{1,0,0}{Term}, \textcolor[rgb]{1,0,0}{Term}) \textcolor[rgb]{1,0,0}{RelationVariable}\\
$\qquad${\small (u, v) $\in$ R}\\
$\qquad${\small (g x, g y) $\in$ S}\\
\textcolor[rgb]{0,0,1}{\textbf{Implication}} \textcolor[rgb]{1,0,0}{Formula Formula}\\
$\qquad${\small (\textit{formula}${}_1$) $\Rightarrow$ (\textit{formula}${}_2$)}\\
\textcolor[rgb]{0,0,1}{\textbf{Equivalence}} \textcolor[rgb]{1,0,0}{Term Term}\\
$\qquad${\small x = y}\\
$\qquad${\small f x = g y}\\
\end{block}
}
\end{frame}

\begin{frame}
\frametitle{Generiranje izreka}
\framesubtitle{Kreiranje osnovnih relacij}
\begin{itemize}
\item V vhodnem tipu poišče vse spremenljivke. \\ % Samo spremenljivke, ne konstantnih tipov.
\texttt{(a -> [b] -> a) -> Int -> c} $\quad\longmapsto\quad$ \texttt{a, b, c}
\item Vsaki spremenljivki priredi par tipovnih spremenljivk ter relacijsko spremenljivko.\\
Sestavi začetek formule:\\
$\quad\forall\, \texttt{t}_1, \texttt{t}_2 \in \textsc{Types},\; \texttt{R} \subseteq \texttt{t}_1\times \texttt{t}_2\,$.
\hfill\textcolor[rgb]{0.75,0.75,0.75}{$\leftarrow$ pripada \texttt{a}}\\
$\quad\quad\forall\, \texttt{t}_3, \texttt{t}_4 \in \textsc{Types},\; \texttt{S} \subseteq \texttt{t}_3\times \texttt{t}_4\,$.
\hfill\textcolor[rgb]{0.75,0.75,0.75}{$\leftarrow$ pripada \texttt{b}}\\
$\quad\quad\quad\forall\, \texttt{t}_5, \texttt{t}_6 \in \textsc{Types},\; \texttt{T} \subseteq \texttt{t}_5\times \texttt{t}_6\,$.
\hfill\textcolor[rgb]{0.75,0.75,0.75}{$\leftarrow$ pripada \texttt{c}}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Generiranje izreka}
\framesubtitle{Pretvorba spremenljivk, konstantnih tipov ter seznamov}
\texttt{
\begin{block}{}
formula :: Term -> Term -> Type -> Formula
\end{block}
formula term${}_1$ term${}_2$ type = \textcolor[rgb]{0,0,1}{case} type \textcolor[rgb]{0,0,1}{of}
\begin{itemize}
\item TypeVar \textcolor[rgb]{0.2,0.8,0.2}{a} $\longmapsto$ IsMember (term${}_1$, term${}_2$) \textcolor[rgb]{1,0.41,0.13}{R${}_a$}\\
$\quad${\footnotesize \textcolor[rgb]{1,0.41,0.13}{R${}_a$} {\sffamily osnovna relacija, ki pripada spremenljivki} \textcolor[rgb]{0.2,0.8,0.2}{a}}
\item TypeConst \textcolor[rgb]{0.2,0.8,0.2}{c} $\longmapsto$ Equivalence term${}_1$ term${}_2$ %po izreku o parametričnosti
\item TypeList t $\longmapsto$ IsMember (term${}_1$, term${}_2$) \textcolor[rgb]{1,0.41,0.13}{[Rel${}_t$]}\\
{\footnotesize
$\quad$\textcolor[rgb]{1,0.41,0.13}{[Rel${}_t$]} {\sffamily sestavljena relacija, ki pripada tipu t}\\
$\quad\;$\textcolor[rgb]{1,0.41,0.13}{Rel${}_t$} = \textcolor[rgb]{0,0,1}{case} t \textcolor[rgb]{0,0,1}{of}\\
$\quad\quad$TypeVar \textcolor[rgb]{0.2,0.8,0.2}{a} $\rightarrow$ {\sffamily osnovna relacija, ki pripada sprem. }\textcolor[rgb]{0.2,0.8,0.2}{a}\\
$\quad\quad$TypeConst \textcolor[rgb]{0.2,0.8,0.2}{c} $\rightarrow$ \textcolor[rgb]{1,0.41,0.13}{Id${}_{\mathtt{c}}$}
$\quad$npr. \textcolor[rgb]{1,0.41,0.13}{Id${}_{\mathtt{Bool}}$}, \textcolor[rgb]{1,0.41,0.13}{Id${}_{\mathtt{Double}}$}, ...\\
$\quad\quad$TypeList ty $\rightarrow$ \textcolor[rgb]{1,0.41,0.13}{[} {\sffamily sestavljena relacija, ki pripada tipu }ty 
\textcolor[rgb]{1,0.41,0.13}{]}\\
$\quad\quad$TypeFun t${}_1$ t${}_2$ $\rightarrow$ ({\sffamily sestavljena relacija, ki pripada tipu }t${}_1$) \textcolor[rgb]{1,0.41,0.13}{->}\\
$\quad\quad$\phantom{TypeFun t${}_1$ t${}_2$ $\rightarrow$ }({\sffamily sestavljena relacija, ki pripada tipu }t${}_2$)
}
\end{itemize}
}
\end{frame}

\begin{frame}
\frametitle{Generiranje izreka}
\framesubtitle{Pretvorba funkcij}
\texttt{
\begin{block}{}
formula :: Term -> Term -> Type -> Formula
\end{block}
formula term${}_1$ term${}_2$ type = \textcolor[rgb]{0,0,1}{case} type \textcolor[rgb]{0,0,1}{of}
\begin{itemize}
\item TypeFun (TypeVar \textcolor[rgb]{0.2,0.8,0.2}{a}) b $\longmapsto$ \\
\textcolor[rgb]{0,0,1}{let} (\textcolor[rgb]{0.2,0.8,0.2}{x}, \textcolor[rgb]{0.2,0.8,0.2}{y}) $\leftarrow$ generator \ 
{\footnotesize\sffamily \textcolor[rgb]{0.75,0.75,0.75}{generira spremenljivki za nova izraza}}\\
$\phantom{let\ }$ \textcolor[rgb]{1,0.41,0.13}{R${}_{\mathtt{a}}$} = {\sffamily osnovna relacija, ki pripada sprem. }\textcolor[rgb]{0.2,0.8,0.2}{a}\\
$\phantom{let\ }$ nextFormula = formula\\
$\qquad\quad$ (TermApp term${}_1$ (TermVar \textcolor[rgb]{0.2,0.8,0.2}{x}))\\
$\qquad\quad$ (TermApp term${}_2$ (TermVar \textcolor[rgb]{0.2,0.8,0.2}{y})) \\ $\qquad\quad$ b \\
\textcolor[rgb]{0,0,1}{in\ } ForallPairs (\textcolor[rgb]{0.2,0.8,0.2}{x}, \textcolor[rgb]{0.2,0.8,0.2}{y})
\textcolor[rgb]{1,0.41,0.13}{R${}_{\mathtt{a}}$} nextFormula
\end{itemize}
}
\end{frame}

\begin{frame}
\frametitle{Generiranje izreka}
\framesubtitle{Pretvorba funkcij}
\texttt{
\begin{block}{}
formula :: Term -> Term -> Type -> Formula
\end{block}
formula term${}_1$ term${}_2$ type = \textcolor[rgb]{0,0,1}{case} type \textcolor[rgb]{0,0,1}{of}
\begin{itemize}
\item TypeFun (TypeConst \textcolor[rgb]{0.2,0.8,0.2}{c}) b $\longmapsto$ \\
\textcolor[rgb]{0,0,1}{let} \textcolor[rgb]{0.2,0.8,0.2}{z} $\leftarrow$ generator \ 
{\footnotesize\sffamily \textcolor[rgb]{0.75,0.75,0.75}{generira spremenljivko za nov izraz}}\\
$\phantom{let\ }$ nextFormula = formula\\
$\qquad\quad$ (TermApp term${}_1$ (TermVar \textcolor[rgb]{0.2,0.8,0.2}{z}))\\
$\qquad\quad$ (TermApp term${}_2$ (TermVar \textcolor[rgb]{0.2,0.8,0.2}{z})) \\ $\qquad\quad$ b \\
\textcolor[rgb]{0,0,1}{in\ } ForallVariables \textcolor[rgb]{0.2,0.8,0.2}{z}
(TypeConst \textcolor[rgb]{0.2,0.8,0.2}{c}) nextFormula
\end{itemize}
}
\end{frame}

\begin{frame}
\frametitle{Generiranje izreka}
\framesubtitle{Pretvorba funkcij}
\texttt{
\begin{block}{}
formula :: Term -> Term -> Type -> Formula
\end{block}
formula term${}_1$ term${}_2$ type = \textcolor[rgb]{0,0,1}{case} type \textcolor[rgb]{0,0,1}{of}
\begin{itemize}
\item TypeFun (TypeList ty) b $\longmapsto$ \\
\textcolor[rgb]{0,0,1}{let} (\textcolor[rgb]{0.2,0.8,0.2}{u}, \textcolor[rgb]{0.2,0.8,0.2}{v}) $\leftarrow$ generator \ 
{\footnotesize\sffamily \textcolor[rgb]{0.75,0.75,0.75}{generira spremenljivki za nova izraza}}\\
$\phantom{let\ }$ \textcolor[rgb]{1,0.41,0.13}{[R${}_{\mathtt{ty}}$]} = {\sffamily sestavljena relacija, ki pripada tipu } [ty]\\
$\phantom{let\ }$ nextFormula = formula\\
$\qquad\quad$ (TermApp term${}_1$ (TermVar \textcolor[rgb]{0.2,0.8,0.2}{u}))\\
$\qquad\quad$ (TermApp term${}_2$ (TermVar \textcolor[rgb]{0.2,0.8,0.2}{v})) \\ $\qquad\quad$ b \\
\textcolor[rgb]{0,0,1}{in\ } ForallPairs (\textcolor[rgb]{0.2,0.8,0.2}{u}, \textcolor[rgb]{0.2,0.8,0.2}{v})
\textcolor[rgb]{1,0.41,0.13}{[R${}_{\mathtt{ty}}$]} nextFormula
\end{itemize}
}
\end{frame}

\begin{frame}
\frametitle{Generiranje izreka}
\framesubtitle{Pretvorba funkcij}
$R\subseteq t_1\times t_2$, $S\subseteq t_3\times t_4$ $\Longrightarrow$\\
$R\rightarrow S =\{(g,h)\, |\, g :: t_1\rightarrow t_3, h :: t_2\rightarrow t_4\}$
\texttt{
%\begin{block}{}
%formula :: Term -> Term -> Type -> Formula
%\end{block}
%formula term${}_1$ term${}_2$ type = \textcolor[rgb]{0,0,1}{case} type \textcolor[rgb]{0,0,1}{of}
\begin{itemize}
\item TypeFun a b $\longmapsto$ \\
\textcolor[rgb]{0,0,1}{let} (\textcolor[rgb]{0.2,0.8,0.2}{g}, \textcolor[rgb]{0.2,0.8,0.2}{h}) $\leftarrow$ generator \ 
{\footnotesize\sffamily \textcolor[rgb]{0.75,0.75,0.75}{spremenljivki za novi funkciji}}\\
$\phantom{let\ }$ R = {\sffamily sestavljena relacija, ki pripada tipu } a -> b\\
$\phantom{let\ }$ leftFunctionType = {\sffamily levi funkcijski tip relacije } R\\
$\phantom{let\ }$ rightFunctionType = {\sffamily desni funkcijski tip relacije } R\\
$\phantom{let\ }$ fstFormula = formula\\
$\qquad\quad$ (TermVar \textcolor[rgb]{0.2,0.8,0.2}{g}, TermVar \textcolor[rgb]{0.2,0.8,0.2}{h}) a \\
$\phantom{let\ }$ sndFormula = formula\\
$\qquad\quad$ (TermApp term${}_1$ (TermVar \textcolor[rgb]{0.2,0.8,0.2}{g}))\\
$\qquad\quad$ (TermApp term${}_2$ (TermVar \textcolor[rgb]{0.2,0.8,0.2}{h})) \\ $\qquad\quad$ b \\
\textcolor[rgb]{0,0,1}{in\ } ForallVariables \textcolor[rgb]{0.2,0.8,0.2}{g} leftFunctionType \$ \\
$\phantom{in\ }\quad$ ForallVariables \textcolor[rgb]{0.2,0.8,0.2}{h} rightFunctionType \$ \\
$\phantom{in\ }\quad\quad$ Implication fstFormula sndFormula \\
\end{itemize}
}
\end{frame}


\end{document}